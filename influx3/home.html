<!DOCTYPE html>
<html>
  <head>
    <meta
      name="generator"
      content="HTML Tidy for HTML5 for Apple macOS version 5.8.0"
    />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC"
      crossorigin="anonymous"
    />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/admin-lte@3.2/dist/css/adminlte.min.css"
    />

    <script
      defer
      src="https://use.fontawesome.com/releases/v5.15.4/js/all.js"
      integrity="sha384-rOA1PnstxnOBLzCLMcre8ybwbTmemjzdNlILg8O7z1lUkLXozs4DHonlDtnE7fpc"
      crossorigin="anonymous"
    ></script>
    <script
      src="https://code.jquery.com/jquery-3.6.0.min.js"
      integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4="
      crossorigin="anonymous"
    ></script>
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
      crossorigin="anonymous"
    ></script>
    <script src="https://cdn.jsdelivr.net/npm/admin-lte@3.2/dist/js/adminlte.min.js"></script>
    <script
      type="text/javascript"
      src="https://cdn.jsdelivr.net/momentjs/latest/moment.min.js"
    ></script>

    <script
      src="https://cdnjs.cloudflare.com/ajax/libs/tempusdominus-bootstrap-4/5.39.0/js/tempusdominus-bootstrap-4.min.js"
      integrity="sha512-k6/Bkb8Fxf/c1Tkyl39yJwcOZ1P4cRrJu77p83zJjN2Z55prbFHxPs9vN7q3l3+tSMGPDdoH51AEU8Vgo1cgAA=="
      crossorigin="anonymous"
    ></script>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/tempusdominus-bootstrap-4/5.39.0/css/tempusdominus-bootstrap-4.min.css"
      integrity="sha512-3JRrEUwaCkFUBLK1N8HehwQgu8e23jTH4np5NHOmQOobuC4ROQxFwFgBLTnhcnQRMs84muMh0PnnwXlPq5MGjg=="
      crossorigin="anonymous"
    />
    <script
      type="text/javascript"
      src="https://cdn.jsdelivr.net/npm/daterangepicker/daterangepicker.min.js"
    ></script>
    <link
      rel="stylesheet"
      type="text/css"
      href="https://cdn.jsdelivr.net/npm/daterangepicker/daterangepicker.css"
    />

    <title>Poste 1</title>
  </head>
  <body class="sidebar-collapse">
    <div class="wrapper">
      <div class="content-wrapper" style="min-height: 244.75px">
        <div class="content-header">
          <div class="container-fluid">
            <div class="row mb-2">
              <div class="col-sm-6">
                <h1 class="m-0">Download data</h1>
              </div>
            </div>
          </div>
        </div>
        <div class="content">
          <div class="container-fluid">
            <div class="row">
              <div class="col-lg-12">
                <div class="card">
                  <div class="card-body">
                    <div class="row">
                      <div class="col-sm-12">
                        <div class="form-group">
                          
                          <label>Date and time range:</label>
                          
                          <div class="input-group">
                            <div class="input-group-prepend">
                              <span class="input-group-text"
                                ><i class="far fa-clock"></i
                              ></span>
                            </div>
                            <input
                              type="text"
                              class="form-control float-right"
                              id="reservationtime"
                            />
                          </div>
                          
                        </div>
                      </div>
                    </div>
                    <div class="row">
                      <div class="col-sm-12"></div>
                    </div>
                    <div class="form-group">
                      <label>Plant</label
                      ><select id="select_plant" class="form-control">
                        <option value="U3QSV4iSps5kwU6T6S5HDl0kq3Ze2IpG">
                          Bologna CMP
                        </option>
                        <option value="W3MSV5eTkr8duX6R6V3BFh3ih4Ya5FqM">
                          Bologna Direzionale
                        </option>
                        <option
                          value="S1MUV5iSbs8jtU5S6S5BJl2jr4Ye5DpK-V3TXQ4lSau8guW5R9W6EKl0in1Vg5DpL"
                        >
                          Sesto Fiorentino
                        </option>
                        <option
                          value="S3MYW3jVoq6dpY6U6S6PEh2kk3Ug2DpL-S3MTW5hXjp8ipW6S6U3GFl3ni4Wb4FqC"
                        >
                          Napoli
                        </option>
                        <option value="S3MYU4gUfu5epZ7U7Q5JKh3nr2Ye5JpC">
                          Fiumicino 2
                        </option>
                        <option value="S3NUQ3kSdt5iwS5T9W3DFh1mj3Za4EqK">
                          Modena
                        </option>
                        <option value="T3OUV3lUds8gtS5Y6T6CKl3jr3Ug4GpB">
                          Brescia
                        </option>
                        <option
                          value="U1QUU3jTlu8kvX5Y7Q6HJh1hi2Vg5JpM-U1RVQ4gTfu8ftT4T9X6LIl2in1Ug4HpF"
                        >
                          Modugno
                        </option>
                        <option value="U1RTS4eUgp6hvY7S8X3DEl1hh2Xb4EpL">
                          Palermo
                        </option>
                        <option value="U2QUU2iXgt6hwY7W7W4FIl3ln3Uc4FpN">
                          Parma
                        </option>
                        <option value="U3QYU4hTat5jvW6W7X3EEh2jc3Wb2EpN">
                          Lamezia Terme
                        </option>
                        <option value="V3SYW2lTbp7hwY4S6U4IHh2jh2Sd5DpG">
                          Melzo
                        </option>
                        <option value="W2MVW3jWfq5dtY5X6X6PEh2hn1Sh5JpP">
                          Genova CMP
                        </option>
                        <option value="Y1RXR4gQbr6ktX7W8Q4JIl0jq4Td3JqN">
                          Pomezia
                        </option>
                        <option
                          value="Z1SUW2lUcp5jsT4R6S4MJl1lq4Vc3KqJ-W3MRV3lXir5iqU5V6V4KGl2mh3Uc5EqG"
                        >
                          Torino
                        </option>
                      </select>
                    </div>
                    <div class="form-group">
                      <label>Timeframe</label
                      ><select id="select_timeframe" class="form-control">
                        <option value="0">Hourly</option>
                        <option value="1">Every 15 minutes</option>
                      </select>
                    </div>
                    <a href="#" class="btn btn-primary" onclick="downloadData()"
                      >Download data</a
                    >
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <footer class="main-footer">
        <strong
          >Copyright &copy; 2022
          <a href="https://canavisia.com">Canavisia</a>.</strong
        >All rights reserved.
      </footer>
      <div id="sidebar-overlay"></div>
    </div>
   
   <script>
      var endDate = (new Date().getTime() / 1000).toFixed(0);
      var startDate = endDate - 60 * 60 * 24;
      $(function () {
        $("#reservationtime").daterangepicker({
          startDate: new Date(startDate * 1000),
          endDate: new Date(endDate * 1000),
          timePicker: true,
          timePickerIncrement: 60,
          timePicker24Hour: true,
          ranges: {
            "Last 24h": [moment().subtract(1, "days"), moment()],
            "Last 7 days": [moment().subtract(1, "week"), moment()],
            "Last Month": [moment().subtract(1, "month"), moment()],
            "Last Year": [moment().subtract(1, "year"), moment()],
          },
          locale: {
            format: "DD/MM/YYYY HH:mm",
          },
        });

        $("#reservationtime").on(
          "apply.daterangepicker",
          function (ev, picker) {
            sd = new Date(picker.startDate.format("YYYY-MM-DDTHH:mm:ss"));
            ed = new Date(picker.endDate.format("YYYY-MM-DDTHH:mm:ss"));
            startDate = (sd.getTime() / 1000).toFixed(0);
            endDate = (ed.getTime() / 1000).toFixed(0);
          }
        );
      });

      function downloadData() {
        var st = document.getElementById("select_timeframe");
        var apikey = document.getElementById("select_plant").value;
        if (apikey.includes("-")) {
          var split = apikey.split("-");
          apikey = split[0];
          apikey2 = split[1];
          window.location =
            "/data?apikey=" +
            apikey +
            "&apikey2=" +
            apikey2 +
            "&timeframe=" +
            st.options[st.selectedIndex].value +
            "&start=" +
            startDate +
            "&stop=" +
            endDate;
        } else {
          window.location =
            "/data?apikey=" +
            apikey +
            "&timeframe=" +
            st.options[st.selectedIndex].value +
            "&start=" +
            startDate +
            "&stop=" +
            endDate;
        }
      }
    </script>
  </body>
</html>
